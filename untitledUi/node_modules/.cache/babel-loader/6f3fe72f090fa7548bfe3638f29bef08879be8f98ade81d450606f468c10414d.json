{"ast":null,"code":"import { slicedToArray as n } from \"../../../../_virtual/_rollupPluginBabelHelpers.js\";\nimport { useState as a, useEffect as l, useCallback as r } from \"react\";\nimport { calculateSteppedValue as i } from \"../utils/calcValue.js\";\nvar e = function (e) {\n  var t = e.value,\n    o = e.onChange,\n    u = e.min,\n    v = e.max,\n    d = e.step,\n    f = void 0 === d ? 1 : d,\n    s = e.disabled,\n    m = e.readOnly,\n    p = e.allowOutOfBounds,\n    c = e.onValidityChange,\n    h = a(null === t ? \"\" : t + \"\"),\n    g = n(h, 2),\n    w = g[0],\n    y = g[1];\n  l(function () {\n    var n = null === t ? \"\" : t + \"\";\n    y(function (a) {\n      return t !== parseFloat(a) ? n : a;\n    });\n  }, [t]);\n  var x = r(function (n) {\n    var a = n.target.value;\n    if (\"\" === a) return y(\"\"), void o(null, n);\n    if (/^-?\\d*\\.?\\d*$/.test(a)) {\n      y(a);\n      var l = \"-\" === a || a.endsWith(\".\");\n      if (l && 1 === a.length && a.endsWith(\".\")) o(0, n);else if (!l) {\n        var r = parseFloat(a);\n        if (p) return void (r !== t && o(r, n));\n        var i = Math.max(null != u ? u : -1 / 0, Math.min(null != v ? v : 1 / 0, r));\n        i !== t && o(i, n);\n      }\n    }\n  }, [o, p, u, v, t]);\n  l(function () {\n    c && c(null === t || !(void 0 !== u && u > t || void 0 !== v && t > v));\n  }, [t, u, v, c]);\n  var A = r(function (n) {\n    if (!s && !m) {\n      var a = \"ArrowUp\" === n.key;\n      if (a || \"ArrowDown\" === n.key) {\n        n.preventDefault();\n        var l = i({\n          value: t,\n          direction: a ? 1 : -1,\n          step: f,\n          min: u,\n          max: v,\n          allowOutOfBounds: p\n        });\n        o(l, n);\n      }\n    }\n  }, [t, f, u, v, o, s, m, p]);\n  return {\n    inputValue: w,\n    numericValue: t,\n    onChange: x,\n    onKeyDown: A,\n    isAtMin: !p && null !== t && void 0 !== u && u >= t,\n    isAtMax: !p && null !== t && void 0 !== v && t >= v\n  };\n};\nexport { e as default };","map":{"version":3,"names":["e","useNumberFieldState","t","value","o","onChange","u","min","v","max","d","step","f","s","disabled","m","readOnly","p","allowOutOfBounds","c","onValidityChange","h","a","g","n","w","y","l","parseFloat","x","r","target","test","endsWith","length","i","Math","A","key","preventDefault","direction","inputValue","numericValue","onKeyDown","isAtMin","isAtMax","default"],"sources":["/Users/ankish/Downloads/MA/MAPIT/untitledUi/node_modules/@vibe/core/src/components/NumberField/hooks/useNumberFieldState.ts"],"sourcesContent":["import { useCallback, useEffect, useState } from \"react\";\nimport { NumberFieldProps } from \"../NumberField.types\";\nimport { calculateSteppedValue } from \"../utils/calcValue\";\n\nexport type UseNumberFieldStateProps = Pick<\n  NumberFieldProps,\n  \"value\" | \"onChange\" | \"min\" | \"max\" | \"step\" | \"disabled\" | \"readOnly\" | \"allowOutOfBounds\" | \"onValidityChange\"\n>;\n\nconst useNumberFieldState = ({\n  value: controlledValue,\n  onChange,\n  min,\n  max,\n  step = 1,\n  disabled,\n  readOnly,\n  allowOutOfBounds,\n  onValidityChange\n}: UseNumberFieldStateProps) => {\n  const [inputValue, setInputValue] = useState(controlledValue === null ? \"\" : String(controlledValue));\n\n  useEffect(() => {\n    const controlledValueStr = controlledValue === null ? \"\" : String(controlledValue);\n    setInputValue(prevInputValue =>\n      controlledValue !== parseFloat(prevInputValue) ? controlledValueStr : prevInputValue\n    );\n  }, [controlledValue]);\n\n  const handleChange = useCallback(\n    (event: React.ChangeEvent<HTMLInputElement>) => {\n      const stringValue = event.target.value;\n\n      if (stringValue === \"\") {\n        setInputValue(\"\");\n        onChange(null, event);\n        return;\n      }\n\n      const numericRegex = /^-?\\d*\\.?\\d*$/;\n      if (!numericRegex.test(stringValue)) {\n        return;\n      }\n\n      setInputValue(stringValue);\n      const isPartial = stringValue === \"-\" || stringValue.endsWith(\".\");\n      if (isPartial && stringValue.length === 1 && stringValue.endsWith(\".\")) {\n        onChange(0, event);\n        return;\n      }\n\n      if (!isPartial) {\n        const newNumber = parseFloat(stringValue);\n        if (allowOutOfBounds) {\n          if (newNumber !== controlledValue) {\n            onChange(newNumber, event);\n          }\n          return;\n        }\n\n        const clampedValue = Math.max(min ?? -Infinity, Math.min(max ?? Infinity, newNumber));\n        if (clampedValue !== controlledValue) {\n          onChange(clampedValue, event);\n        }\n      }\n    },\n    [onChange, allowOutOfBounds, min, max, controlledValue]\n  );\n\n  useEffect(() => {\n    if (!onValidityChange) return;\n\n    if (controlledValue === null) {\n      onValidityChange(true);\n      return;\n    }\n\n    const isWithinBounds =\n      (min === undefined || controlledValue >= min) && (max === undefined || controlledValue <= max);\n    onValidityChange(isWithinBounds);\n  }, [controlledValue, min, max, onValidityChange]);\n\n  const handleKeyDown = useCallback(\n    (event: React.KeyboardEvent<HTMLInputElement>) => {\n      if (disabled || readOnly) {\n        return;\n      }\n\n      const isArrowUp = event.key === \"ArrowUp\";\n      const isArrowDown = event.key === \"ArrowDown\";\n\n      if (isArrowUp || isArrowDown) {\n        event.preventDefault();\n        const direction = isArrowUp ? 1 : -1;\n        const newValue = calculateSteppedValue({\n          value: controlledValue,\n          direction,\n          step,\n          min,\n          max,\n          allowOutOfBounds\n        });\n        onChange(newValue, event);\n      }\n    },\n    [controlledValue, step, min, max, onChange, disabled, readOnly, allowOutOfBounds]\n  );\n\n  const isAtMin = !allowOutOfBounds && controlledValue !== null && min !== undefined && controlledValue <= min;\n  const isAtMax = !allowOutOfBounds && controlledValue !== null && max !== undefined && controlledValue >= max;\n\n  return {\n    inputValue,\n    numericValue: controlledValue,\n    onChange: handleChange,\n    onKeyDown: handleKeyDown,\n    isAtMin,\n    isAtMax\n  };\n};\n\nexport default useNumberFieldState;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}