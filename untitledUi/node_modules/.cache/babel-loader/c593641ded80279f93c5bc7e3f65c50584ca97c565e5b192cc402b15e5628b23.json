{"ast":null,"code":"import { defineProperty as e } from \"../../../../_virtual/_rollupPluginBabelHelpers.js\";\nimport { __rest as t } from \"../../../../_virtual/_tslib.js\";\nimport r, { forwardRef as n, useCallback as o, useEffect as i, useMemo as l } from \"react\";\nimport s from \"../TableBody/TableBody.js\";\nimport a from \"./TableVirtualizedBody.module.scss.js\";\nimport { FixedSizeList as c } from \"react-window\";\nimport { useTable as m } from \"../context/TableContext/TableContext.js\";\nimport u from \"classnames\";\nimport { getTestId as d } from \"../../../tests/testIds.js\";\nimport { ComponentDefaultTestId as f } from \"../../../tests/constants.js\";\nimport { RowHeights as v } from \"../Table/TableConsts.js\";\nimport p from \"react-virtualized-auto-sizer\";\nimport { useTableRowMenu as b } from \"../context/TableRowMenuContext/TableRowMenuContext.js\";\nvar h = r.memo(function (e) {\n    var n,\n      o = e.style,\n      i = (0, e.rowRenderer)(e.item),\n      l = t(o, [\"width\"]);\n    return r.cloneElement(i, {\n      style: Object.assign(Object.assign({}, l), null === (n = i.props) || void 0 === n ? void 0 : n.style)\n    });\n  }),\n  T = n(function (T, g) {\n    var j = T.items,\n      w = T.rowRenderer,\n      y = T.onScroll,\n      E = T.columns,\n      R = T.headerRenderer,\n      x = T.id,\n      z = T.className,\n      C = T[\"data-testid\"],\n      B = T.overscanCount,\n      L = void 0 === B ? 1 : B,\n      _ = m(),\n      O = _.size,\n      S = _.virtualizedListRef,\n      V = _.onVirtualizedListScroll,\n      A = _.markTableAsVirtualized,\n      D = b().resetHoveredRow,\n      H = !!E && !!R,\n      I = o(function (e) {\n        var t = e.target;\n        D(), V({\n          target: t,\n          currentTarget: t\n        });\n      }, [D, V]);\n    i(function () {\n      var e = S.current;\n      if (e) return e.addEventListener(\"scroll\", I), function () {\n        e.removeEventListener(\"scroll\", I);\n      };\n    }, [I, S]);\n    var M = o(function (e) {\n        H || null == y || y(e.scrollDirection, e.scrollOffset, e.scrollUpdateWasRequested);\n      }, [y, H]),\n      N = o(function (e) {\n        var t = e.index;\n        return H && 0 === t ? null : r.createElement(h, {\n          item: j[H ? t - 1 : t],\n          rowRenderer: w,\n          style: e.style\n        });\n      }, [j, w, H]);\n    i(function () {\n      H || A();\n    }, [A, H]);\n    var P = l(function () {\n      return H ? n(function (e, n) {\n        var o = e.children,\n          i = t(e, [\"children\"]);\n        return r.createElement(\"div\", Object.assign({\n          ref: n\n        }, i), R(E), o);\n      }) : void 0;\n    }, [H, R, E]);\n    return r.createElement(s, {\n      className: u(a.tableBody, e({}, a.withHeader, H), z),\n      id: x,\n      \"data-testid\": C || d(f.TABLE_VIRTUALIZED_BODY, x),\n      ref: g\n    }, (null == j ? void 0 : j.length) && r.createElement(p, null, function (e) {\n      return r.createElement(c, {\n        itemSize: v[O],\n        height: e.height,\n        itemCount: H ? j.length + 1 : j.length,\n        width: e.width,\n        overscanCount: L,\n        onScroll: M,\n        outerRef: function (e) {\n          S.current = e;\n        },\n        innerElementType: P\n      }, N);\n    }));\n  });\nexport { T as default };","map":{"version":3,"names":["h","r","memo","e","n","o","style","i","rowRenderer","item","l","t","cloneElement","Object","assign","props","T","g","j","items","w","y","onScroll","E","columns","R","headerRenderer","x","id","z","className","C","B","overscanCount","L","_","m","O","size","S","virtualizedListRef","V","onVirtualizedListScroll","A","markTableAsVirtualized","D","b","resetHoveredRow","H","I","target","currentTarget","current","addEventListener","removeEventListener","M","scrollDirection","scrollOffset","scrollUpdateWasRequested","N","index","createElement","P","children","ref","s","u","a","tableBody","withHeader","d","f","TABLE_VIRTUALIZED_BODY","length","p","c","itemSize","v","height","itemCount","width","outerRef","innerElementType","default"],"sources":["/Users/ankish/Downloads/MA/MAPIT/untitledUi/node_modules/@vibe/core/src/components/Table/TableVirtualizedBody/TableVirtualizedBody.tsx"],"sourcesContent":["import React, { ComponentType, forwardRef, useCallback, useEffect, useMemo } from \"react\";\nimport { VibeComponentProps } from \"../../../types\";\nimport TableBody from \"../TableBody/TableBody\";\nimport styles from \"./TableVirtualizedBody.module.scss\";\nimport { FixedSizeList as List, ListChildComponentProps, ScrollDirection } from \"react-window\";\nimport { useTable } from \"../context/TableContext/TableContext\";\nimport cx from \"classnames\";\nimport { getTestId } from \"../../../tests/test-ids-utils\";\nimport { ComponentDefaultTestId } from \"../../../tests/constants\";\nimport { RowHeights } from \"../Table/TableConsts\";\nimport AutoSizer, { Size as AutoSizerSize } from \"react-virtualized-auto-sizer\";\nimport { useTableRowMenu } from \"../context/TableRowMenuContext/TableRowMenuContext\";\nimport { TableColumn } from \"../Table/Table\";\n\nexport type TableVirtualizedRow = Record<string, unknown> & { id: string };\n\nexport interface TableVirtualizedBodyProps<T extends TableVirtualizedRow = TableVirtualizedRow>\n  extends VibeComponentProps {\n  /**\n   * The list of items to render in the virtualized table.\n   */\n  items: T[];\n  /**\n   * Function to render a row in the table.\n   */\n  rowRenderer: (item: T) => JSX.Element;\n  /**\n   * Callback function triggered on scroll.\n   */\n  onScroll?: (horizontalScrollDirection: ScrollDirection, scrollTop: number, scrollUpdateWasRequested: boolean) => void;\n  /**\n   * The columns configuration for the table.\n   */\n  columns?: TableColumn[];\n  /**\n   * Function to render the table header.\n   */\n  headerRenderer?: (columns: TableColumn[]) => JSX.Element;\n  /**\n   * Number of rows to render above/below the visible area.\n   */\n  overscanCount?: number;\n}\n\nconst MemoizedRow = React.memo(\n  <T extends TableVirtualizedRow>({\n    item,\n    rowRenderer,\n    style\n  }: {\n    item: T;\n    rowRenderer: (item: T) => JSX.Element;\n    style: React.CSSProperties;\n  }) => {\n    const element = rowRenderer(item);\n    const { width: _width, ...styleWithoutWidth } = style;\n    return React.cloneElement(element, {\n      style: { ...styleWithoutWidth, ...element.props?.style }\n    });\n  }\n);\n\nconst TableVirtualizedBody = forwardRef(\n  <T extends TableVirtualizedRow = TableVirtualizedRow>(\n    {\n      items,\n      rowRenderer,\n      onScroll,\n      columns,\n      headerRenderer,\n      id,\n      className,\n      \"data-testid\": dataTestId,\n      overscanCount = 1\n    }: TableVirtualizedBodyProps<T>,\n    ref: React.ForwardedRef<HTMLDivElement>\n  ) => {\n    const { size, virtualizedListRef, onVirtualizedListScroll, markTableAsVirtualized } = useTable();\n    const { resetHoveredRow } = useTableRowMenu();\n    const virtualizedWithHeader = !!columns && !!headerRenderer;\n\n    const handleOuterScroll = useCallback(\n      (e: Event) => {\n        const target = e.target as HTMLDivElement;\n        resetHoveredRow();\n        onVirtualizedListScroll({\n          target,\n          currentTarget: target\n        } as unknown as React.UIEvent<HTMLDivElement>);\n      },\n      [resetHoveredRow, onVirtualizedListScroll]\n    );\n\n    useEffect(() => {\n      const scrollElement = virtualizedListRef.current;\n      if (!scrollElement) return;\n\n      scrollElement.addEventListener(\"scroll\", handleOuterScroll);\n\n      return () => {\n        scrollElement.removeEventListener(\"scroll\", handleOuterScroll);\n      };\n    }, [handleOuterScroll, virtualizedListRef]);\n\n    const handleVirtualizedVerticalScroll = useCallback(\n      ({\n        scrollDirection,\n        scrollOffset,\n        scrollUpdateWasRequested\n      }: {\n        scrollDirection: ScrollDirection;\n        scrollOffset: number;\n        scrollUpdateWasRequested: boolean;\n      }) => {\n        if (virtualizedWithHeader) return;\n        onScroll?.(scrollDirection, scrollOffset, scrollUpdateWasRequested);\n      },\n      [onScroll, virtualizedWithHeader]\n    );\n\n    const itemRenderer = useCallback<ComponentType<ListChildComponentProps<T>>>(\n      ({ index, style }) => {\n        if (virtualizedWithHeader && index === 0) {\n          return null; //placeholder for virtualized with header\n        }\n        const currentIndex = virtualizedWithHeader ? index - 1 : index;\n        const currentItem = items[currentIndex];\n\n        return <MemoizedRow item={currentItem} rowRenderer={rowRenderer} style={style} />;\n      },\n      [items, rowRenderer, virtualizedWithHeader]\n    );\n\n    useEffect(() => {\n      if (!virtualizedWithHeader) markTableAsVirtualized();\n    }, [markTableAsVirtualized, virtualizedWithHeader]);\n\n    const memoizedInnerElementType = useMemo(\n      () =>\n        virtualizedWithHeader\n          ? forwardRef(({ children, ...rest }: any, ref: React.Ref<HTMLDivElement>) => (\n              <div ref={ref} {...rest}>\n                {headerRenderer!(columns!)}\n                {children}\n              </div>\n            ))\n          : undefined,\n      [virtualizedWithHeader, headerRenderer, columns]\n    );\n\n    return (\n      <TableBody\n        className={cx(\n          styles.tableBody,\n          {\n            [styles.withHeader]: virtualizedWithHeader\n          },\n          className\n        )}\n        id={id}\n        data-testid={dataTestId || getTestId(ComponentDefaultTestId.TABLE_VIRTUALIZED_BODY, id)}\n        ref={ref}\n      >\n        {items?.length && (\n          <AutoSizer>\n            {({ height, width }: AutoSizerSize) => (\n              <List\n                itemSize={RowHeights[size]}\n                height={height}\n                itemCount={virtualizedWithHeader ? items.length + 1 : items.length}\n                width={width}\n                overscanCount={overscanCount}\n                onScroll={handleVirtualizedVerticalScroll}\n                outerRef={element => {\n                  virtualizedListRef.current = element;\n                }}\n                innerElementType={memoizedInnerElementType}\n              >\n                {itemRenderer}\n              </List>\n            )}\n          </AutoSizer>\n        )}\n      </TableBody>\n    );\n  }\n);\n\nexport default TableVirtualizedBody;\n"],"mappings":";;;;;;;;;;;;;AA4CA,IAAMA,CAAA,GAAcC,CAAA,CAAMC,IAAA,CACxB,UAAAC,CAAA;IAQK,IAAAC,CAAA;MALHC,CAAA,GAAKF,CAAA,CAALG,KAAA;MAMMC,CAAA,IAAU,GAPLJ,CAAA,CAAXK,WAAA,EADIL,CAAA,CAAJM,IAAA;MAS0BC,CAAA,GAAsBC,CAAA,CAAAN,CAAA,EAA1C;IACN,OAAOJ,CAAA,CAAMW,YAAA,CAAaL,CAAA,EAAS;MACjCD,KAAA,EAAKO,MAAA,CAAAC,MAAA,CAAAD,MAAA,CAAAC,MAAA,KAAOJ,CAAA,GAAqC,UAAfN,CAAA,GAAAG,CAAA,CAAQQ,KAAA,UAAO,MAAAX,CAAA,YAAAA,CAAA,CAAAE,KAAA;IAAA,EAErD;EAAA;EAGIU,CAAA,GAAuBZ,CAAA,CAC3B,UAAAY,CAAA,EAYEC,CAAA;IACE,IAXAC,CAAA,GAAKF,CAAA,CAALG,KAAA;MACAC,CAAA,GAAWJ,CAAA,CAAXR,WAAA;MACAa,CAAA,GAAQL,CAAA,CAARM,QAAA;MACAC,CAAA,GAAOP,CAAA,CAAPQ,OAAA;MACAC,CAAA,GAAcT,CAAA,CAAdU,cAAA;MACAC,CAAA,GAAEX,CAAA,CAAFY,EAAA;MACAC,CAAA,GAASb,CAAA,CAATc,SAAA;MACeC,CAAA,GAAUf,CAAA,CAAzB;MAAagB,CAAA,GAAAhB,CAAA,CACbiB,aAAA;MAAAC,CAAA,QAAgB,MAAHF,CAAA,GAAG,IAACA,CAAA;MAInBG,CAAA,GAAsFC,CAAA;MAA9EC,CAAA,GAAIF,CAAA,CAAJG,IAAA;MAAMC,CAAA,GAAkBJ,CAAA,CAAlBK,kBAAA;MAAoBC,CAAA,GAAuBN,CAAA,CAAvBO,uBAAA;MAAyBC,CAAA,GAAsBR,CAAA,CAAtBS,sBAAA;MACnDC,CAAA,GAAoBC,CAAA,GAApBC,eAAA;MACFC,CAAA,KAA0BzB,CAAA,MAAaE,CAAA;MAEvCwB,CAAA,GAAoB5C,CAAA,CACxB,UAACF,CAAA;QACC,IAAMQ,CAAA,GAASR,CAAA,CAAE+C,MAAA;QACjBL,CAAA,IACAJ,CAAA,CAAwB;UACtBS,MAAA,EAAAvC,CAAA;UACAwC,aAAA,EAAexC;QAAA,EAEnB;MAAA,GACA,CAACkC,CAAA,EAAiBJ,CAAA;IAGpBlC,CAAA,CAAU;MACR,IAAMJ,CAAA,GAAgBoC,CAAA,CAAmBa,OAAA;MACzC,IAAKjD,CAAA,EAIL,OAFAA,CAAA,CAAckD,gBAAA,CAAiB,UAAUJ,CAAA,GAElC;QACL9C,CAAA,CAAcmD,mBAAA,CAAoB,UAAUL,CAAA;MAAA,CAEhD;IAAA,GAAG,CAACA,CAAA,EAAmBV,CAAA;IAEvB,IAAMgB,CAAA,GAAkClD,CAAA,CACtC,UAAAF,CAAA;QASM6C,CAAA,IACJ,QAAA3B,CAAA,IAAAA,CAAA,CATelB,CAAA,CAAfqD,eAAA,EACYrD,CAAA,CAAZsD,YAAA,EACwBtD,CAAA,CAAxBuD,wBAAA,CAQF;MAAA,GACA,CAACrC,CAAA,EAAU2B,CAAA;MAGPW,CAAA,GAAetD,CAAA,CACnB,UAAAF,CAAA;QAAqB,IAAlBQ,CAAA,GAAKR,CAAA,CAALyD,KAAA;QACD,OAAIZ,CAAA,IAAmC,MAAVrC,CAAA,GACpB,OAKFV,CAAA,CAAC4D,aAAA,CAAA7D,CAAA,EAAY;UAAAS,IAAA,EAFAS,CAAA,CADC8B,CAAA,GAAwBrC,CAAA,GAAQ,IAAIA,CAAA;UAGlBH,WAAA,EAAaY,CAAA;UAAad,KAAA,EAPpDH,CAAA,CAALG;QAAA,EAQT;MAAA,GACD,CAACY,CAAA,EAAOE,CAAA,EAAa4B,CAAA;IAGvBzC,CAAA,CAAU;MACHyC,CAAA,IAAuBL,CAAA,EAC9B;IAAA,GAAG,CAACA,CAAA,EAAwBK,CAAA;IAE5B,IAAMc,CAAA,GAA2BpD,CAAA,CAC/B;MAAA,OACEsC,CAAA,GACI5C,CAAA,CAAW,UAACD,CAAA,EAA4BC,CAAA;QAA5B,IAAEC,CAAA,GAAwBF,CAAA,CAAxB4D,QAAA;UAAaxD,CAAA,GAAII,CAAA,CAAAR,CAAA,EAAnB;QAA+D,OACzEF,CAAA,CAAK4D,aAAA,QAAAhD,MAAA,CAAAC,MAAA;UAAAkD,GAAA,EAAK5D;QAAA,GAASG,CAAA,GAChBkB,CAAA,CAAgBF,CAAA,GAChBlB,CAAA,CAEJ;MAAA,UACD,CAAS;IAAA,GACf,CAAC2C,CAAA,EAAuBvB,CAAA,EAAgBF,CAAA;IAG1C,OACEtB,CAAA,CAAC4D,aAAA,CAAAI,CAAA,EACC;MAAAnC,SAAA,EAAWoC,CAAA,CACTC,CAAA,CAAOC,SAAA,EAASjE,CAAA,CAEb,IAAAgE,CAAA,CAAOE,UAAA,EAAarB,CAAA,GAEvBnB,CAAA;MAEFD,EAAA,EAAID,CAAA;MAAE,eACOI,CAAA,IAAcuC,CAAA,CAAUC,CAAA,CAAuBC,sBAAA,EAAwB7C,CAAA;MACpFqC,GAAA,EAAK/C;IAAA,IAEJ,QAAAC,CAAA,YAAAA,CAAA,CAAOuD,MAAA,KACNxE,CAAA,CAAC4D,aAAA,CAAAa,CAAA,QACE,UAAAvE,CAAA;MAAgB,OACfF,CAAA,CAAA4D,aAAA,CAACc,CAAA,EACC;QAAAC,QAAA,EAAUC,CAAA,CAAWxC,CAAA;QACrByC,MAAA,EAHM3E,CAAA,CAAN2E,MAAA;QAIAC,SAAA,EAAW/B,CAAA,GAAwB9B,CAAA,CAAMuD,MAAA,GAAS,IAAIvD,CAAA,CAAMuD,MAAA;QAC5DO,KAAA,EALa7E,CAAA,CAAL6E,KAAA;QAMR/C,aAAA,EAAeC,CAAA;QACfZ,QAAA,EAAUiC,CAAA;QACV0B,QAAA,EAAU,SAAAA,CAAA9E,CAAA;UACRoC,CAAA,CAAmBa,OAAA,GAAUjD,CAC9B;QAAA;QACD+E,gBAAA,EAAkBpB;MAAA,GAEjBH,CAAA,CAEJ;IAAA,GAKX;EAAA;AAAA,SAAA3C,CAAA,IAAAmE,OAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}